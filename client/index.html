<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
	<style>
    	* { 
			padding: 0; 
			margin: 10; 
		}
    	canvas { 
			background: #eee; 
			display: block; 
			margin: 0 auto; 
		}
    </style>
</head>

<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<body>

<canvas id="myCanvas"></canvas>

<script>

var canvas = document.getElementById("myCanvas");
var ctx = canvas.getContext("2d");

var gridWidth = document.body.clientWidth = 1000;
var gridHeight = document.body.clientHeight = 500;

canvas.width = gridWidth;
canvas.height = gridHeight;

var cellSize = 50;
var map = [];

function drawGrid() {
	for (y = 0; y < gridHeight / cellSize; y++) {
	map[y] = [];
		for (x = 0; x < gridWidth / cellSize; x++) {
			map[y][x] = {
				x: x,
				y: y,
				type: 0
			};
			ctx.beginPath();
			ctx.rect(x * cellSize, y * cellSize, cellSize, cellSize);
			ctx.strokeStyle = "grey";
			ctx.stroke();
			ctx.closePath();
		}
	}
}

function returnCellData(e) {
	var clickX = Math.floor((e.pageX - canvas.offsetLeft) / cellSize);
	var clickY = Math.floor((e.pageY - canvas.offsetTop) / cellSize);
	for (y = 0; y < gridHeight / cellSize; y++) {
		for (x = 0; x < gridWidth / cellSize; x++) {
			if (map[y][x].x == clickX && map[y][x].y == clickY) {
				console.log(map[y][x]);
				break;
			}
		}
	}
}

function update() {
	drawGrid();
}

document.addEventListener("click", returnCellData);
setInterval(update, 10);

var socket = io();
console.log("hello");
socket.on('start', function(data) {
  map = data;
  console.log(map);
});

</script>

</body>
</html>